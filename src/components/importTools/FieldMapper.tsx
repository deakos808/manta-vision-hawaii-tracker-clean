<entire file content from my last message's Patch 1 (the long overwrite)>
